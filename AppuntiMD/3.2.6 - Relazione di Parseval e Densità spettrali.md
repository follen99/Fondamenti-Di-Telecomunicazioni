# Relazione di Parseval

[TOC]

La relazione di Parseval è una **teoria matematica** che afferma che **l'energia di un segnale** può essere calcolata sia integrando il modulo quadro del segnale nel dominio del tempo, sia integrando il modulo quadro **dello spettro** nel dominio della frequenza!

Vediamo perchè:

La prima cosa da fare è scriverci la formula dell'energia, esplicitiamo il modulo quadro e successivamente cerchiamo di calcolare la trasformata inversa di Fourier applicando la definizione:

![image-20230226161147335](./assets/image-20230226161147335.png)

Sostituiamo quindi al segnale x la sua forma scritta in termini di trasformata inversa:

![image-20230226161255551](./assets/image-20230226161255551.png)

Otteniamo un integrale all'interno dell'integrale iniziale; siccome è un segnale di energia possiamo scambiare l'ordine degli elementi all'interno degli integrali:

<img src="./assets/image-20230226161411224.png" alt="image-20230226161411224" style="zoom:20%;" />

Ma notiamo che (ponendo il segnale all'interno del secondo integrale ed il suo spettro fuori), "salta fuori" proprio lo spettro del segnale (non coniugato!
Scriviamoci questo integrale come lo spettro del segnale x:

<img src="./assets/image-20230226161511743.png" alt="image-20230226161511743" style="zoom:30%;" />

Notiamo che Lo spettro di x moltiplicato per lo spettro di x coniugato **non è altro che il modulo quadro dello spettro di x!**

## Morale della favola

Abbiamo capito quindi che possiamo scrivere l'energia di un segnale sia come l'integrazione del suo segnale in modulo quadro, sia come integrazione del **suo spettro** in modulo quadro; questo è molto importante, perchè ci dice che **l'energia viene conservata** indipendentemente dal dominio in cui ci troviamo!

![image-20230226161837748](./assets/image-20230226161837748.png)



# Densità spettrali

## Densità spettrale di energia

Definiamo la densità spettrale di energia per **segnali di energia** (segnali limitati come le finestre) ed è proprio il modulo quadro dello spettro del segnale:

![image-20230227162428242](./assets/image-20230227162428242.png)

### Proprietà della densità spettrale di energia

1. Per segnali reali, la densità spettrale di energia sarà **pari**:
   ![image-20230227162613626](./assets/image-20230227162613626.png)
2. La densità spettrale di energia **è invariante temporalmente**; questa proprietà ci dice che il **modulo** del segnale non varia quando effettuiamo la trasformata:
   ![image-20230227162803195](./assets/image-20230227162803195.png)
3. Funzione di trasferimento di energia: questa funzione corrisponde alla "densità spettrale" della risposta impulsiva:
   ![image-20230227162900649](./assets/image-20230227162900649.png)

## La banda

La banda è essenzialmente un "range di frequenze" a cui si fa riferimento quando si parla di segnali nel dominio della frequenza:

![image-20230227163219163](./assets/image-20230227163219163.png)

### Esempio: calcolare la percentuale di energia conservata in una data banda

Prendiamo come esempio un impulso rettangolare, che in frequenza corrisponde ad una sinc:

![image-20230227163352560](./assets/image-20230227163352560.png)

Il prossimo passaggio è quello di trovare la densità spettrale di energia del segnale:

![image-20230227163444041](./assets/image-20230227163444041.png)

Dopo aver trovato S<sub>x</sub>(f) possiamo proseguire a calcolare la percentuale di energia che si conserva in un dato intervallo (banda):

![image-20230227163551515](./assets/image-20230227163551515.png)

Abbiamo scelto gli estremi come (-K/T, K/T) perchè corrispondono ai primi "zeri" della sinc:

![image-20230227163654539](./assets/image-20230227163654539.png)

A questo punto non ci resta che rispolvere l'integrale normalmente:

![image-20230227163840987](./assets/image-20230227163840987.png)

Poniamo K={1,2,...N} e controlliamo per quale valore di K (e quindi per quale banda) si conserva almeno il 99% dell'energia:

![image-20230227163940959](./assets/image-20230227163940959.png)

Notiamo che solo per K=10 otteniamo una conservazione dell'energia pari al 99%; questo vuol dire che la banda che ci consente di racchiudere il 99% dell'energia è data dall'intervallo: (-10/T, 10/T)

### Esempio: Calcolare la banda che consente di conservare il 95% dell'energia

Il segnale in questione questa volta è l'esponenziale monolatero decrescente:

![image-20230227164308727](./assets/image-20230227164308727.png)

Teniamo pronte la trasformata del segnale e la sua energia; la prima cosa da fare è trovare la densità spettrale:

![image-20230227164358467](./assets/image-20230227164358467.png)

Siccome conosciamo la formula dell'energia, cerchiamo di isolarla dalla densità spettrale in modo da facilitare i calcoli successivamente. A questo punto non ci resta che calcolare l'energia in un intervallo generico (banda):

![image-20230227164530220](./assets/image-20230227164530220.png)

Abbiamo i due "pezzi" che ci servivano, procediamo a calcolare la frazione ponendo il tutto uguale all'energia richiesta, ovvero 95%:

![image-20230227164615213](./assets/image-20230227164615213.png)

Ci viene fuori che la banda richiesta affinchè si conservi il 95% dell'energia del segnale iniziale è 12.7/T.

## Densità spettrale di potenza

Quando abbiamo ricavato la densità spettrale di energia, abbiamo sfruttato l'uguaglianza di Parseval; non possiamo fare lo stesso anche con i segnali di potenza perchè l'uguaglianza di Parseval si applica **solo a segnali di energia**, mentre i segnali di potenza hanno energia infinita.

Possiamo però sfruttare un "trucco" per applicare l'uguaglianza anche in questo caso: ci basta ricordare la definizione di potenza e, ovviamente, l'uguaglianza di Parseval:

![image-20230227165249436](./assets/image-20230227165249436.png)

A questo punto possiamo **finestrare il segnale di potenza** con un segnale finestra rettangolare, e sapremo che la trasformata di questo segnale sarà lo spettro del segnale di potenza **di periodo T**:

![image-20230227165359231](./assets/image-20230227165359231.png)

Andiamo a calcolare la potenza di questo segnale; solo a questo punto **applichiamo l'uguaglianza di parseval**, scrivendo:

![image-20230227165422857](./assets/image-20230227165422857.png)

A questo punto ci basta solo portare il limite all'interno dell'integrale per vincere:

 ![image-20230227165522698](./assets/image-20230227165522698.png)

Siccome <u>per definizione</u> **la densità spettrale è quella quantità che integrata ci dà l'energia**, possiamo battezzare il limite appena ottenuto **densità spettrale di potenza**:

![image-20230227165604235](./assets/image-20230227165604235.png)

# Densità spettrali mutue

Come abbiamo visto che esiste la **mutua correlazione**, esistono anche le densità spettrali mutue.

## Densità spettrale di mutua energia

Possiamo rispolverare la definizione di energia, sia per segnali a tempo continuo che a tempo discreto; usiamo poi Parseval per trasformare il tutto in frequenza:

![image-20230227170402547](./assets/image-20230227170402547.png)

Ancora una volta per il discorso usato nella densità spettrale di potenza, la densità spettrale è quella quantità che integrata ci restituisce l'energia, quindi:

![image-20230227170504349](./assets/image-20230227170504349.png)

## Densità spettrale di mutua potenza

Ancora una volta dobbiamo ricorrere ad un "trick" per poterci calcolare la densità spettrale di mutua potenza, siccome non possiamo usare Parseval direttamente:

![Immagine PNG 23](./assets/Immagine PNG 23.png)

Andiamo ad applicare un filtro e successivamente integriamo:

![Immagine PNG 24](./assets/Immagine PNG 24.png)

Anche in questo caso portiamo il limite dentro l'integrale e lo battezziamo densità spettrale di mutua potenza:

![Immagine PNG 25](./assets/Immagine PNG 25.png)

Possiamo fare lo stesso ragionamento per segnali di potenza **a tempo discreto**:

![Immagine PNG 26](./assets/Immagine PNG 26.png)

# Relazione tra Mutua Correlazione e Densità Spettrale Mutua - Teorema di Wiener-Kintchin

Abbiamo una relazione molto importante tra queste due quantità:

![image-20230227195728058](./assets/image-20230227195728058.png)

Oppure, in formule (più semplicemente):

<img src="./assets/image-20230227195937265.png" alt="image-20230227195937265" style="zoom:15%;" />

La dimostrazione comprende degli integrali doppi e sopratutto **non è argomento di esame**, e per questo motivo, ce la saltiamo.



