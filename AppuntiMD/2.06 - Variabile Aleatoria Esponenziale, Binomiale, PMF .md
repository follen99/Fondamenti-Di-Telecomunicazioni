## Piccolo Recap

Nella lezione precedente abbiamo visto una particolare funzione che si definisce a partire dalla variabile aleatoria, in particolare abbiamo definito la **funzione di distribuzione cumulativa** (CDF).
Abbiamo visto che nel caso di variabili aleatorie **discrete** (il cui alfabeto √® discreto, ovvero finito o numerabile) la funzione ha sempre un andamento del tipo **Costante a tratti**:

![image-20221221161029982](https://tva1.sinaimg.cn/large/008vxvgGgy1h9bu3w1utsj31qw0rsn13.jpg)

> Insieme finito

![image-20221221163804789](https://tva1.sinaimg.cn/large/008vxvgGgy1h9buwk8bwgj31i30rsgoq.jpg)

> Insieme infinito numerabile

Queste variabili aleatorie sono caratterizzate dal fatto di avere una CDF che non √® pi√π **costante a tratti** (come nelle immagini precedenti).
Inoltre, CDF vale sempre **zero** per x --> -‚àû, vale sempre **uno** per x --> +‚àû ed √® una funzione che **non potr√† mai decrescere**: questo perch√® √® un **cumulo di probabilit√†**, e visto che le probabilit√† sono sempre ‚â• 0, non potr√† mai decrescere.

## Propriet√† della CDF

- F<sub>x</sub>(-‚àû) = 0
- F<sub>x</sub>(+‚àû) = 1
- F<sub>x</sub>(x) √® una **funzione non decrescente**
- F<sub>x</sub>(x) = √® continua **da destra**: i valori che assume sono continui da destra, mentre a sinistra pu√≤ avere salti di discontinuit√† come abbiamo visto nei grafici precedenti:

![CodeCogsEqn](https://tva1.sinaimg.cn/large/008vxvgGgy1h9dxfh9jx3j306j00x0sj.jpg)

# CDF Continua Uniforme

E' possibile definire queste CDF direttamente, senza dover passare per l'esperimento, ma esistono, sulla base di **esperimenti reali**, alcuni casi di CDF:

Questo √® proprio il caso della **CDF Continua uniforme** in un certo intervallo (a,b).

![image-20221223114156272](https://tva1.sinaimg.cn/large/008vxvgGgy1h9dxl2gszaj31ag0rswh3.jpg)

> La variabile aleatoria √® uniforme nell'intervallo a -> b

Dal punto di vista grafico abbiamo:

![image-20221223114650699](https://tva1.sinaimg.cn/large/008vxvgGgy1h9dxq67jfgj31ir0rsgp1.jpg)

Per tradurre il tutto in formule, dobbiamo prima trovare la funzione della retta tra a e b (ovvero quella in viola):

![image-20221223115235150](https://tva1.sinaimg.cn/large/008vxvgGgy1h9dxw4gvyzj314j0rsjts.jpg)

Successivamente possiamo scrivere le tre formule:

![IMG_D1054BDEE9DF-1](/Users/follen/Downloads/IMG_D1054BDEE9DF-1.jpeg)

> Questo tipo di variabile aleatoria modella esperimenti in cui la probabilit√† di un evento non dipende dal momento in cui l'evento si verifica, ma dipende **unicamente** dalla dimensione dell'evento.

Capiamo quindi che la probabilit√† che si verifichi un evento (ad esempio la probabilit√† che un viaggiatore arrivi in un determinato momento) dipende dall'ampiezza dell'intervallo di tempo, ma non dipende dove questo intervallo di tempo √® allocato!

![image-20221223120322187](https://tva1.sinaimg.cn/large/008vxvgGgy1h9dy7dqdxwj31i00rs0xs.jpg)

## Esperimento

Le variabili uniformi sono abbastanza comuni nel mondo reale, un esempio potrebbe essere il seguente:

Un giocatore si mette accostato ad un muro e lancia una moneta; se questa moneta tocca il muro il giocatore perde, se invece non tocca il muro, vince chi posiziona la moneta pi√π vicino al muro.
Nel caso ipotetico in cui il giocatore getta la moneta "a caso" e questa non tocca il muro, **la distanza tra la moneta ed il muro √® una variabile uniforme**.

Di variabili continue ce ne sono molte, in particolare studieremo:

- Variabile aleatoria esponenziale
- Variabile aleatoria ???????



# Variabile Aleatoria Esponenziale

Anche in questo caso abbiamo una variabile continua dove la CDF (F<sub>X</sub>(x)) √® del tipo:

![image-20221223170046671](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e6strsz5j31d80rsdjs.jpg)

> A differenza dell'uniforme (che aveva due parametri a e b) questa variabile aleatoria ha solo un parametro

Ora, se tracciamo il grafico di e<sup>-x</sup> otteniamo il seguente grafico; √® ovvio che e<sup>-x</sup> in x<sub>0</sub>=0 vale 1.

![image-20221223170024789](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e6sjhpuhj31ii0rstbr.jpg)

Ci accorgiamo per√≤, che la nostra funzione **F<sub>X</sub>(x) = (1 - e<sup>-Œªx</sup>) u(x)** vale **zero** in  x<sub>0</sub>=0, mentre vale **uno** per x --> ‚àû :

![image-20221223170813832](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e70kumk8j318l0rstbp.jpg)

Inoltre, il pezzo `u(x)` fa s√¨ che si debba moltiplicare la funzione per `1` quando x √® maggiore di zero, e per `0 `quando la funzione √® minore di zero.

![](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e73l6rhvj32a20rsn1s.jpg)

Otteniamo quindi il grafico:

![](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e77kezvpj31kw0rrdix.jpg)

Valgono quindi le **Propriet√† costitutive della CDF**

- F<sub>X</sub>(x) = 0 in (- ‚àû, 0)
- F<sub>X</sub>(x) = 1 per x -> +‚àû
- F<sub>X</sub>(x) √® **non decrescente**

Ogni funzione che **rispetta** queste 3 propriet√† **√® legittimamente una CDF**.

---

Andiamo a definire altre due funzioni; mentre la CDF √® definibile allo stesso modo sia per variabili aleatorie discrete che continue. Di queste due nuove funzioni invece, una fa riferimento alle variabili discrete, e l'altra a quelle continue.

# PMF - Probability Mass Function - Per variabili aleatorie discrete

![image-20221223175338456](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e8bt0jvnj31kw0rsn02.jpg)

Ed √® la probabilit√† che la X (variabile aleatoria) assuma uno dei valori del suo alfabeto (x, ovvero i valori che la variabile aleatoria pu√≤ assumere); nel caso del lancio del dado √® definita per i valori Œ©={1, 2, 3, 4, 5, 6}. 

Nel caso del lancio del dado inoltre, tutti i valori hanno la stessa probabilit√† di verificarsi, ma non √® questo l'unico caso!

## Variabile aleatoria Binomiale (aka Conteggio dei successi di Bernoulli)

Supponiamo di lanciare una moneta per `N` volte; definiamo come `successo` il caso in cui l'uscita √® testa, mentre come `insuccesso` il caso in cui l'uscita sia croce. Una volta svolto l'esperimento, costruiamo una variabile aleatoria che assume come valore il numero di volte che ci √® uscito testa, ad esempio:

![](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e8ma477qj323w0rsjv8.jpg)

> Su 4 volte ci esce testa una sola volta

![](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e8mwty7zj31oc0rsq5y.jpg)

> Su 4 volte ci esce sempre testa

In quest'ultimo caso precisamente (4 teste o 4 croci su 4 lanci) ottenere 4 teste √® l'unico modo di avere X = 4; √® ben diverso dal caso in cui, su 4 lanci, ci interessasse avere X = 2, infatti ci sono diversi modi per ottenere che X = 2 su 4 lanci:

- {T,T,C,C}
- {T,C,T,C}
- ...

Cerchiamo di calcolare la probabilit√†:

![](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e8t4fedoj31e80rs775.jpg)

Qual √® la probabilit√† di X = N? Ovvero qual √® la probabilit√† di ottenere, ad esempio, 5 con 5 lanci?

![](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e8wlxyypj31f50rstbr.jpg)

Ed invece la probabilit√† di ottenere testa al primo lancio e tutte croci per il resto dei lanci (N)?

![image-20221223181913938](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e92h6q5qj312j0rrgo3.jpg)

E la probabilit√† di avere testa ai primi due lanci e poi sempre croce?

![image-20221223182116058](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e94m94lwj31wf0rs0vc.jpg)

Quindi, la probabilit√† che **P(X = K) = p<sup>k</sup> (1 - p)<sup>N-K</sup>**

Qual √® la probabilit√† di avere, in generale, una testa ed N-1 croci? Ovvero un successo ed N-1 insuccessi?

Capiamo bene che ci sono diversi casi possibili, perch√® il nostro successo possiamo averlo al primo lancio, al secondo, al terzo... ovvero fino all'n-esimo lancio:

![image-20221223183510982](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e9j2d0zmj30wv0rstbu.jpg)

Quante sono le combinazioni?

![image-20221223183902506](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e9n2ljv1j31eq0rsdjt.jpg)

**Concludendo** come possiamo avere il **conteggio dei successi**?

![image-20221223184250402](https://tva1.sinaimg.cn/large/008vxvgGgy1h9e9r0cnl4j31p40rstcj.jpg)

> Consideriamo k che va da zero ad N perch√® possiamo avere da **zero successi** fino ad **N successi**.

üèÅ1:00

---

# Variabile aleatoria di Poisson (usata in fisica)

Questa variabile aleatoria modella degli **il numero di arrivi casuali in un certo intervallo di tempo**; questa variabile √® molto usata nella `teoria delle code`: se abbiamo una coda, possiamo modellare il numero di pacchetti che arrivano in una certa coda (pacchetti che vanno smaltiti/inviati).

Affinch√® gli arrivi siano modellabili nel modo corretto, √® necessario che valgano alcune propriet√†:

- **Non possono arrivare pi√π arrivi contemporaneamente** (devono arrivare separatamente): se siamo in una coda, due pacchetti non devono arrivare contemporaneamente.
- **Gli arrivi devono essere indipendenti**: se prendiamo due intervalli di tempo disgiunti, gli arrivi che abbiamo in certo intervallo **non dipendono / sono indipendenti** dall'altro intervallo di tempo.
- ...

Poisson ha definito la variabile aleatoria sulla base di un'equazione differenziale, che definisce le probabilit√† di avere un **certo numero di arrivi in un certo intervallo di tempo**

## Equazioni differenziali Stocastiche

Una volta definite le propriet√† dell'evento fisico che vado a modellare (l'equazione modella il fenomeno statistico/fisico), poich√® l'incognita risultante √® una **funzione** ([vedi equazioni differenziali](https://github.com/follen99/Analisi/blob/main/Appunti/2.01%20-%20Equazioni%20Differenziali/Lezione%2033.pdf)) che ha delle caratteristiche di una PMF, allora la **soluzione all'equazione differenziale** √® proprio la PMF (funzione).

In generale, le PMF devono **soddisfare un'equazione differenziale**, che tramite risoluzione, ci fa "trovare" la PMF stessa.

---

## La Variabile Aleatoria (sempre PMF)

![image-20221226103839192](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hcm7ya8rj31is0rsjur.jpg)



Matlab ci permette di visualizzare in modo chiaro diversi esperimenti di tipo probabilistico, tra cui le PMF, PDF; ci consente quindi di fare cose molto interessanti.

k va da 0 ad infinito, quindi i valori sull'asse delle x sono definiti per tutti i punti da 0 ad infinito.

Quando andiamo a definire una **CDF** andiamo a **cumulare** delle probabilit√†; quando definiamo le **PMF** non si parla di cumulazione, ma di veri e propri **salti** di probabilit√† (non cumulati); questo vuol dire che la forma di tutti i salti di probabilit√† che otteniamo nelle CDF ci dovrebbe portare ad 1 (la CDF tende ad 1).

Essendo quelli della PMF dei salti di probabilit√† (ogni "calcolo" ci restituisce la probabilit√† che x assuma valore k), la somma di tutti i "calcoli" dovrebbe proprio restituirci 1:

![image-20221226105259767](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hd12ic6qj31td0rs772.jpg)

Se ricordiamo l'espansione in serie di Taylor / Mc Laurin di **e<sup>x</sup>** notiamo che corrisponde proprio a...

![image-20221226105916205](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hd7lrt5rj32lm0rsq6l.jpg)

Questo ci permette di scrivere:

![image-20221226110105900](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hd9hh9vij32gb0rsjtv.jpg)

In questo modo riusciamo a dimostrare che anche in questo caso la somma di tutti i "salti" √® proprio 1.

## PMF e CDF

La PMF nel punto k equivale al salto di discontinuit√† della CDF:

![image-20221226110708829](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hdftogguj31j70rs77f.jpg)

> √à una sorta di **derivata discreta**; questo concetto apre le porte alla definizione di PDF, che √® un qualcosa di simile applicato per√≤ **alla continuit√†**, e non al discreto.
>
> La PDF √® definita proprio come la **derivata prima** della CDF.

Se volessimo calcolare la derivata della CDF otterremmo:

![image-20221226111714226](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hdqapxwoj31m20rsdie.jpg)

> La derivata dei segmenti **costanti** √® sicuramente zero

![image-20221226111929459](https://tva1.sinaimg.cn/large/008vxvgGgy1h9hdsn30ylj31rq0rs76v.jpg)

> Per quanto riguardi i punti di discontinuit√† la funzione non √® derivabile!

**Quindi**
Derivando la CDF otterremmo una funzione che √® **sempre zero**, infatti `non avrebbe molto senso`.
Se invece **deriviamo una funzione continua**, che per definizione √® derivabile in tutti i suoi punti, otterremo sicuramente una derivata (sensata!) in ogni punto, che corrisponde alla **pendenza** della curva in quel punto (che ci dice molto!).

`√à proprio per questo motivo che non possiamo usare la stessa definizione sia per contesti discreti che continui.` 



# PDF - Probability Density Function - Per variabili aleatorie continue

--> Prossima lezione
